var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l,c=!1;function s(t,e,n,r){for(;t<e;){const i=t+(e-t>>1);n(i)<=r?t=i+1:e=i}return t}function d(t,e){c?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let i=0;for(let t=0;t<e.length;t++){const o=s(1,i+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[o]+1;const l=o+1;n[l]=t,i=Math.max(l,i)}const o=[],l=[];let c=e.length-1;for(let t=n[i]+1;0!=t;t=r[t-1]){for(o.push(e[t-1]);c>=t;c--)l.push(e[c]);c--}for(;c>=0;c--)l.push(e[c]);o.reverse(),l.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<l.length;e++){for(;n<o.length&&l[e].claim_order>=o[n].claim_order;)n++;const r=n<o.length?o[n]:null;t.insertBefore(l[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function a(t,e,n){c&&!n?d(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function _(t){return document.createTextNode(t)}function f(){return _(" ")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function b(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}class y{constructor(t){this.e=this.n=null,this.l=t}m(t,e,n=null){this.e||(this.e=h(e.nodeName),this.t=e,this.l?this.n=this.l:this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)a(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(u)}}function v(t){l=t}const w=[],x=[],E=[],k=[],j=Promise.resolve();let A=!1;function O(t){E.push(t)}let N=!1;const S=new Set;function B(){if(!N){N=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];v(e),T(e.$$)}for(v(null),w.length=0;x.length;)x.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];S.has(e)||(S.add(e),e())}E.length=0}while(w.length);for(;k.length;)k.pop()();A=!1,N=!1,S.clear()}}function T(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const C=new Set;const M="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function L(t,e){-1===t.$$.dirty[0]&&(w.push(t),A||(A=!0,j.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function P(o,s,d,a,h,_,f=[-1]){const p=l;v(o);const g=o.$$={fragment:null,ctx:null,props:_,update:t,not_equal:h,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:s.context||[]),callbacks:n(),dirty:f,skip_bound:!1};let m=!1;if(g.ctx=d?d(o,s.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return g.ctx&&h(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),m&&L(o,t)),e})):[],g.update(),m=!0,r(g.before_update),g.fragment=!!a&&a(g.ctx),s.target){if(s.hydrate){c=!0;const t=function(t){return Array.from(t.childNodes)}(s.target);g.fragment&&g.fragment.l(t),t.forEach(u)}else g.fragment&&g.fragment.c();s.intro&&(($=o.$$.fragment)&&$.i&&(C.delete($),$.i(b))),function(t,n,o,l){const{fragment:c,on_mount:s,on_destroy:d,after_update:a}=t.$$;c&&c.m(n,o),l||O((()=>{const n=s.map(e).filter(i);d?d.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(O)}(o,s.target,s.anchor,s.customElement),c=!1,B()}var $,b;v(p)}const{window:H}=M;function F(t,e,n){const r=t.slice();return r[15]=e[n],r}function I(t){let e,n,r,i,o,l,c,s,p=t[15].当前路径.map(z).join("/")+"",g=t[15].目前指令+"",$=t[15].指令结果+"";return{c(){e=_("----------------------------------------------------\n  "),n=h("div"),r=_(p),i=f(),o=h("div"),l=_(g),c=f(),s=h("div")},m(t,u){a(t,e,u),a(t,n,u),d(n,r),a(t,i,u),a(t,o,u),d(o,l),a(t,c,u),a(t,s,u),s.innerHTML=$},p(t,e){2&e&&p!==(p=t[15].当前路径.map(z).join("/")+"")&&m(r,p),2&e&&g!==(g=t[15].目前指令+"")&&m(l,g),2&e&&$!==($=t[15].指令结果+"")&&(s.innerHTML=$)},d(t){t&&u(e),t&&u(n),t&&u(i),t&&u(o),t&&u(c),t&&u(s)}}}function q(e){let n,i,o,l,c,s,_,m,v,w,x,E,k=e[1],j=[];for(let t=0;t<k.length;t+=1)j[t]=I(F(e,k,t));return{c(){n=h("a"),n.textContent="帮助",i=f(),o=h("div"),l=h("textarea"),c=f();for(let t=0;t<j.length;t+=1)j[t].c();s=f(),_=h("div"),m=h("input"),v=f(),w=new y,g(n,"target","_blank"),g(n,"href","https://github.com/wuyudi/OperatingSystem/tree/online-demo#%E4%B8%80%E4%B8%AA-shell-%E7%9A%84%E5%9C%A8%E7%BA%BF%E6%A8%A1%E6%8B%9F%E5%99%A8"),b(l,"font-family","Consolas"),b(l,"height","10rem"),b(l,"width","80rem"),b(l,"border-color","transparent"),l.value=e[3],b(m,"width","100%"),w.a=null},m(t,r){a(t,n,r),a(t,i,r),a(t,o,r),d(o,l),a(t,c,r);for(let e=0;e<j.length;e+=1)j[e].m(t,r);a(t,s,r),a(t,_,r),d(_,m),$(m,e[0]),d(_,v),w.m(e[2],_),x||(E=[p(H,"keydown",e[4]),p(m,"input",e[6])],x=!0)},p(t,[e]){if(2&e){let n;for(k=t[1],n=0;n<k.length;n+=1){const r=F(t,k,n);j[n]?j[n].p(r,e):(j[n]=I(r),j[n].c(),j[n].m(s.parentNode,s))}for(;n<j.length;n+=1)j[n].d(1);j.length=k.length}1&e&&m.value!==t[0]&&$(m,t[0]),4&e&&w.p(t[2])},i:t,o:t,d(t){t&&u(n),t&&u(i),t&&u(o),t&&u(c),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(j,t),t&&u(s),t&&u(_),x=!1,r(E)}}}function J(t){return t[t.length-1]}const z=t=>t.name;function D(t,e,n){class r{constructor(t,e){this.name=t,this.content=null!=e?e:""}}class i{constructor(t){this.name=t,this.dir_children={},this.file_children={}}}let o=String.raw`
             _ _                      _          _ _ 
  ___  _ __ | (_)_ __   ___       ___| |__   ___| | |
 / _ \| '_ \| | | '_ \ / _ \_____/ __| '_ \ / _ \ | |
| (_) | | | | | | | | |  __/_____\__ \ | | |  __/ | |
 \___/|_| |_|_|_|_| |_|\___|     |___/_| |_|\___|_|_|
`,l=new i("~"),c=[l];const s=()=>J(c);let d=(t,e)=>{let n=c.slice();for(;e.length>0;){console.log(`文件夹序列 = ${e}`);let r=e.shift();if(".."!==r){if(void 0===(t=t.dir_children[r]))throw console.log("can't get to"),new Error("can't get to");n.push(t)}else n.length>1&&(n.pop(),t=J(n))}return n};let a=new Map([["ls",t=>Object.keys(s().dir_children).map((t=>`<div> ${t}  文件夹</div>`)).join(" ")+Object.keys(s().file_children).map((t=>`<div> ${t}  文件</div>`)).join(" ")],["mkdir",t=>(t.map((t=>s().dir_children[t]=new i(t))),"")],["cd",t=>{let e=t[0];if([...e].every((t=>"."===t))){let t=e.length;for(;t>1&&c.length>1;)c.pop(),t--;return""}if(e.includes("/"))return console.log(e),(t=>{let e=t.split("/");console.log(e);try{n(5,c=d(J(c),e))}catch(t){return"无此目录"}})(e),"";{let t=s().dir_children[e];return void 0!==t?(c.push(t),console.log("新建成功"),""):"can't cd to path"}}],["touch",t=>(t.map((t=>s().file_children[t]=new r(t))),"创建完成")],["cat",t=>{let e=t[0];return s().file_children.hasOwnProperty(e)?s().file_children[e].content:`cat: ${e}: 没有那个文件`}],["echo",t=>{let e=t[0],n=t[2],i=s().file_children[n];return s().file_children.hasOwnProperty(n)?(s().file_children[n]=new r(n,e),""):">"===t[1]?(i.content=e,"写入成功"):">>"===t[1]?(i.content+=e,"追加成功"):void 0}],["rmdir",t=>([...new Set(t)].map((t=>delete s().dir_children[t])),"删除成功")],["rm",t=>([...new Set(t)].map((t=>delete s().file_children[t])),"删除成功")],["cp",t=>{let e=t[0].split("/"),n=J(e),i=t[1].split("/"),o=J(i),l=J(d(s(),e.slice(0,-1))).file_children[n];return void 0===l?"无此文件":(console.log("复制成功"),console.log(`复制成功 后 目前位置 ${JSON.stringify(s())}`),J(d(s(),i.slice(0,-1))).file_children[o]=new r(o,l.content),"")}],["clear",t=>(n(1,h=[{"目前指令":"","指令结果":"","当前路径":J(h).当前路径}]),"")],["exit",t=>(window.close(),"")],["tree",t=>function t(e,n="&nbsp;&nbsp;&nbsp;&nbsp;"){return e instanceof r?`<div>${n} ${e.name} 文件</div>`:`<div>${n} ${e.name} 文件夹</div>\n          <div> ${0!==Object.keys(e.dir_children).length?Object.values(e.dir_children).map((e=>t(e,n+"&nbsp;&nbsp;&nbsp;&nbsp;"))).join("<br/>"):""} \n          </div> <div> ${0!==Object.keys(e.file_children).length?`${Object.values(e.file_children).map((e=>t(e,n+"&nbsp;&nbsp;&nbsp;&nbsp;"))).join("<br/>")}`:""} </div>`}(s(),"<br/>")]]);let u="",h=[{"目前指令":"","指令结果":"","当前路径":[l]}],_="";return t.$$.update=()=>{32&t.$$.dirty&&(n(5,c),console.log(c))},[u,h,_,o,t=>{if("Enter"===t.key){if(""===u)return;n(2,_=function(t){let e=t.split(" "),n=e[0],r=e.slice(1);return new Set(a.keys()).has(n)?a.get(n)(r):"error, 无此指令"}(u)),"clear"!==u&&(n(1,h[h.length-1].目前指令=u,h),n(1,h[h.length-1].指令结果=_,h),h.push({"目前指令":"","指令结果":"","当前路径":c.concat()})),n(0,u=""),n(2,_="")}console.log(t.key)},c,function(){u=this.value,n(0,u)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),P(this,t,D,q,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
