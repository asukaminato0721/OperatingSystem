var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let i,c=!1;function s(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function u(t,e){c?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const l=s(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[l]+1;const i=l+1;n[i]=t,o=Math.max(i,o)}const l=[],i=[];let c=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(l.push(e[t-1]);c>=t;c--)i.push(e[c]);c--}for(;c>=0;c--)i.push(e[c]);l.reverse(),i.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<i.length;e++){for(;n<l.length&&i[e].claim_order>=l[n].claim_order;)n++;const r=n<l.length?l[n]:null;t.insertBefore(i[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function a(t,e,n){c&&!n?u(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function _(){return f(" ")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function $(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}class b{constructor(t){this.e=this.n=null,this.l=t}m(t,e,n=null){this.e||(this.e=h(e.nodeName),this.t=e,this.l?this.n=this.l:this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)a(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(d)}}function v(t){i=t}const w=[],x=[],E=[],k=[],S=Promise.resolve();let F=!1;function O(t){E.push(t)}let j=!1;const A=new Set;function N(){if(!j){j=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];v(e),B(e.$$)}for(v(null),w.length=0;x.length;)x.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];A.has(e)||(A.add(e),e())}E.length=0}while(w.length);for(;k.length;)k.pop()();F=!1,j=!1,A.clear()}}function B(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const C=new Set;const T="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function M(t,e){-1===t.$$.dirty[0]&&(w.push(t),F||(F=!0,S.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(l,s,u,a,h,f,_=[-1]){const p=i;v(l);const g=l.$$={fragment:null,ctx:null,props:f,update:t,not_equal:h,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:s.context||[]),callbacks:n(),dirty:_,skip_bound:!1};let m=!1;if(g.ctx=u?u(l,s.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return g.ctx&&h(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),m&&M(l,t)),e})):[],g.update(),m=!0,r(g.before_update),g.fragment=!!a&&a(g.ctx),s.target){if(s.hydrate){c=!0;const t=function(t){return Array.from(t.childNodes)}(s.target);g.fragment&&g.fragment.l(t),t.forEach(d)}else g.fragment&&g.fragment.c();s.intro&&((y=l.$$.fragment)&&y.i&&(C.delete(y),y.i($))),function(t,n,l,i){const{fragment:c,on_mount:s,on_destroy:u,after_update:a}=t.$$;c&&c.m(n,l),i||O((()=>{const n=s.map(e).filter(o);u?u.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(O)}(l,s.target,s.anchor,s.customElement),c=!1,N()}var y,$;v(p)}const{window:L}=T;function P(t,e,n){const r=t.slice();return r[17]=e[n],r}function J(t){let e,n,r,o,l,i,c,s,p=t[17].当前路径.map(R).join("/")+"",g=t[17].目前指令+"",y=t[17].指令结果+"";return{c(){e=f("----------------------------------------------------\n  "),n=h("div"),r=f(p),o=_(),l=h("div"),i=f(g),c=_(),s=h("div")},m(t,d){a(t,e,d),a(t,n,d),u(n,r),a(t,o,d),a(t,l,d),u(l,i),a(t,c,d),a(t,s,d),s.innerHTML=y},p(t,e){2&e&&p!==(p=t[17].当前路径.map(R).join("/")+"")&&m(r,p),2&e&&g!==(g=t[17].目前指令+"")&&m(i,g),2&e&&y!==(y=t[17].指令结果+"")&&(s.innerHTML=y)},d(t){t&&d(e),t&&d(n),t&&d(o),t&&d(l),t&&d(c),t&&d(s)}}}function H(e){let n,o,l,i,c,s,f,m,v,w,x,E,k,S,F=e[1],O=[];for(let t=0;t<F.length;t+=1)O[t]=J(P(e,F,t));return{c(){n=h("a"),n.textContent="帮助",o=_(),l=h("button"),l.textContent="保存",i=_(),c=h("div"),s=h("textarea"),f=_();for(let t=0;t<O.length;t+=1)O[t].c();m=_(),v=h("div"),w=h("input"),x=_(),E=new b,g(n,"target","_blank"),g(n,"href","https://github.com/wuyudi/OperatingSystem/tree/online-demo#%E4%B8%80%E4%B8%AA-shell-%E7%9A%84%E5%9C%A8%E7%BA%BF%E6%A8%A1%E6%8B%9F%E5%99%A8"),$(s,"font-family","Consolas"),$(s,"height","10rem"),$(s,"width","80rem"),$(s,"border-color","transparent"),s.value=e[3],$(w,"width","100%"),E.a=null},m(t,r){a(t,n,r),a(t,o,r),a(t,l,r),a(t,i,r),a(t,c,r),u(c,s),a(t,f,r);for(let e=0;e<O.length;e+=1)O[e].m(t,r);a(t,m,r),a(t,v,r),u(v,w),y(w,e[0]),u(v,x),E.m(e[2],v),k||(S=[p(L,"keydown",e[5]),p(l,"click",e[6]),p(w,"input",e[7])],k=!0)},p(t,[e]){if(2&e){let n;for(F=t[1],n=0;n<F.length;n+=1){const r=P(t,F,n);O[n]?O[n].p(r,e):(O[n]=J(r),O[n].c(),O[n].m(m.parentNode,m))}for(;n<O.length;n+=1)O[n].d(1);O.length=F.length}1&e&&w.value!==t[0]&&y(w,t[0]),4&e&&E.p(t[2])},i:t,o:t,d(t){t&&d(n),t&&d(o),t&&d(l),t&&d(i),t&&d(c),t&&d(f),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(O,t),t&&d(m),t&&d(v),k=!1,r(S)}}}function q(t){return t[t.length-1]}const R=t=>t.name;function U(t,e,n){var r,o;!function(t){t[t.File=0]="File",t[t.Folder=1]="Folder"}(o||(o={}));class l{constructor(t,e,n){this.name=t,this.type=e,this.content=null!=n?n:"",this.children={}}}let i=String.raw`
             _ _                      _          _ _ 
  ___  _ __ | (_)_ __   ___       ___| |__   ___| | |
 / _ \| '_ \| | | '_ \ / _ \_____/ __| '_ \ / _ \ | |
| (_) | | | | | | | | |  __/_____\__ \ | | |  __/ | |
 \___/|_| |_|_|_|_| |_|\___|     |___/_| |_|\___|_|_|
`,c=null!==(r=JSON.parse(localStorage.getItem("在线终端")))&&void 0!==r?r:new l("~",o.Folder),s=[c];const u=()=>q(s);let a=(t,e)=>{let n=s.slice();for(;e.length>0;){console.log(`文件夹序列 = ${e}`);let r=e.shift();if(".."!==r){if(void 0===(t=t.children[r])||t.type===o.File)throw console.log("can't get to"),new Error("can't get to");n.push(t)}else n.length>1&&(n.pop(),t=q(n))}return n};let d=new Map([["ls",t=>Object.values(u().children).map((t=>{return`<div> ${t.name}  ${t.type===o.Folder?"文件夹":`文件 ${e=t.content,encodeURI(e).split(/%..|./).length-1} Bytes`}</div>`;var e})).join(" ")],["mkdir",t=>{const e=[],n=new Set(Object.keys(u().children));return t.map((t=>{n.has(t)?e.push(`mkdir: 无法创建目录 “${t}”: 文件已存在`):u().children[t]=new l(t,o.Folder)})),e.join("</br>")}],["cd",t=>{let e=t[0];if([...e].every((t=>"."===t))){let t=e.length;for(;t>1&&s.length>1;)s.pop(),t--;return""}if(e.includes("/"))return console.log(e),(t=>{let e=t.split("/");console.log(e);try{s=a(q(s),e)}catch(t){return"无此目录"}})(e),"";{let t=u().children[e];return void 0!==t&&t.type===o.Folder?(s.push(t),console.log("新建成功"),""):"can't cd to path"}}],["touch",t=>{const e=[],n=new Set(Object.keys(u().children));return t.map((t=>{n.has(t)?e.push(`touch: 无法创建目录 “${t}”: 文件已存在`):u().children[t]=new l(t,o.File)})),e.join("</br>")}],["cat",t=>{let e,n,r=t[0];if(r.includes("/")){const t=r.split("/");e=q(a(u(),t.slice(0,-1))).children,console.log(JSON.stringify(e)),n=q(t)}else e=u().children,n=r;return e.hasOwnProperty(n)&&e[n].type===o.File?e[n].content:`cat: ${r}: 没有那个文件`}],["echo",t=>{let e=t[0],n=t[2],r=u().children[n];return u().children.hasOwnProperty(n)&&r.type===o.Folder?`是一个目录: ${n}`:u().children.hasOwnProperty(n)?">"===t[1]?(r.content=e,"写入成功"):">>"===t[1]?(r.content+=e,"追加成功"):void 0:(u().children[n]=new l(n,o.File,e),"写入成功")}],["rm",t=>{const e=[],n=new Set(Object.keys(u().children));return[...new Set(t)].map((t=>{n.has(t)?delete u().children[t]:e.push(`rm: 无法删除 '${t}': 没有那个文件或目录`)})),e.join("</br>")}],["cp",t=>{let e=t[0].split("/"),n=q(e),r=t[1].split("/"),o=q(r),l=q(a(u(),e.slice(0,-1))).children[n];if(void 0===l)return"无此文件";console.log("复制成功"),console.log(`复制成功 后 目前位置 ${JSON.stringify(u())}`);let i=a(u(),r.slice(0,-1));return q(i).children[o]=l,q(i).children[o].name=o,""}],["clear",t=>(n(1,f=[{"目前指令":"","指令结果":"","当前路径":q(f).当前路径}]),"")],["exit",t=>(window.close(),"")],["tree",t=>function t(e,n="&nbsp;&nbsp;&nbsp;&nbsp;"){return e.type===o.File?`<div>${n} ${e.name} 文件</div>`:`<div>${n} ${e.name} 文件夹</div>\n          <div> ${Object.values(e.children).map((e=>t(e,n+"&nbsp;&nbsp;&nbsp;&nbsp;"))).join("<br/>")} \n          </div>`}(u(),"<br/>")]]);let h="",f=[{"目前指令":"","指令结果":"","当前路径":[c]}],_="";return[h,f,_,i,c,t=>{if("Enter"===t.key){if(""===h)return;n(2,_=function(t){let e=t.split(" "),n=e[0],r=e.slice(1);return new Set(d.keys()).has(n)?d.get(n)(r):"error, 无此指令"}(h)),"clear"!==h&&(n(1,f[f.length-1].目前指令=h,f),n(1,f[f.length-1].指令结果=_,f),f.push({"目前指令":"","指令结果":"","当前路径":s.concat()})),n(0,h=""),n(2,_="")}console.log(t.key)},()=>localStorage.setItem("在线终端",JSON.stringify(c)),function(){h=this.value,n(0,h)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),I(this,t,U,H,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
