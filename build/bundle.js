var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l,c=!1;function s(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function u(t,e){c?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const i=s(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[i]+1;const l=i+1;n[l]=t,o=Math.max(l,o)}const i=[],l=[];let c=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(i.push(e[t-1]);c>=t;c--)l.push(e[c]);c--}for(;c>=0;c--)l.push(e[c]);i.reverse(),l.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<l.length;e++){for(;n<i.length&&l[e].claim_order>=i[n].claim_order;)n++;const r=n<i.length?i[n]:null;t.insertBefore(l[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function h(t,e,n){c&&!n?u(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function _(){return f(" ")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function $(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}class b{constructor(t){this.e=this.n=null,this.l=t}m(t,e,n=null){this.e||(this.e=d(e.nodeName),this.t=e,this.l?this.n=this.l:this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)h(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(a)}}function w(t){l=t}const v=[],x=[],E=[],k=[],F=Promise.resolve();let j=!1;function A(t){E.push(t)}let O=!1;const S=new Set;function N(){if(!O){O=!0;do{for(let t=0;t<v.length;t+=1){const e=v[t];w(e),B(e.$$)}for(w(null),v.length=0;x.length;)x.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];S.has(e)||(S.add(e),e())}E.length=0}while(v.length);for(;k.length;)k.pop()();j=!1,O=!1,S.clear()}}function B(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const T=new Set;const C="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function M(t,e){-1===t.$$.dirty[0]&&(v.push(t),j||(j=!0,F.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(i,s,u,h,d,f,_=[-1]){const p=l;w(i);const g=i.$$={fragment:null,ctx:null,props:f,update:t,not_equal:d,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:s.context||[]),callbacks:n(),dirty:_,skip_bound:!1};let m=!1;if(g.ctx=u?u(i,s.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return g.ctx&&d(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),m&&M(i,t)),e})):[],g.update(),m=!0,r(g.before_update),g.fragment=!!h&&h(g.ctx),s.target){if(s.hydrate){c=!0;const t=function(t){return Array.from(t.childNodes)}(s.target);g.fragment&&g.fragment.l(t),t.forEach(a)}else g.fragment&&g.fragment.c();s.intro&&((y=i.$$.fragment)&&y.i&&(T.delete(y),y.i($))),function(t,n,i,l){const{fragment:c,on_mount:s,on_destroy:u,after_update:h}=t.$$;c&&c.m(n,i),l||A((()=>{const n=s.map(e).filter(o);u?u.push(...n):r(n),t.$$.on_mount=[]})),h.forEach(A)}(i,s.target,s.anchor,s.customElement),c=!1,N()}var y,$;w(p)}const{window:P}=C;function H(t,e,n){const r=t.slice();return r[15]=e[n],r}function I(t){let e,n,r,o,i,l,c,s,p=t[15].当前路径.map(z).join("/")+"",g=t[15].目前指令+"",y=t[15].指令结果+"";return{c(){e=f("----------------------------------------------------\n  "),n=d("div"),r=f(p),o=_(),i=d("div"),l=f(g),c=_(),s=d("div")},m(t,a){h(t,e,a),h(t,n,a),u(n,r),h(t,o,a),h(t,i,a),u(i,l),h(t,c,a),h(t,s,a),s.innerHTML=y},p(t,e){2&e&&p!==(p=t[15].当前路径.map(z).join("/")+"")&&m(r,p),2&e&&g!==(g=t[15].目前指令+"")&&m(l,g),2&e&&y!==(y=t[15].指令结果+"")&&(s.innerHTML=y)},d(t){t&&a(e),t&&a(n),t&&a(o),t&&a(i),t&&a(c),t&&a(s)}}}function J(e){let n,o,i,l,c,s,f,m,w,v,x,E,k=e[1],F=[];for(let t=0;t<k.length;t+=1)F[t]=I(H(e,k,t));return{c(){n=d("a"),n.textContent="帮助",o=_(),i=d("div"),l=d("textarea"),c=_();for(let t=0;t<F.length;t+=1)F[t].c();s=_(),f=d("div"),m=d("input"),w=_(),v=new b,g(n,"target","_blank"),g(n,"href","https://github.com/wuyudi/OperatingSystem/tree/online-demo#%E4%B8%80%E4%B8%AA-shell-%E7%9A%84%E5%9C%A8%E7%BA%BF%E6%A8%A1%E6%8B%9F%E5%99%A8"),$(l,"font-family","Consolas"),$(l,"height","10rem"),$(l,"width","80rem"),$(l,"border-color","transparent"),l.value=e[3],$(m,"width","100%"),v.a=null},m(t,r){h(t,n,r),h(t,o,r),h(t,i,r),u(i,l),h(t,c,r);for(let e=0;e<F.length;e+=1)F[e].m(t,r);h(t,s,r),h(t,f,r),u(f,m),y(m,e[0]),u(f,w),v.m(e[2],f),x||(E=[p(P,"keydown",e[4]),p(m,"input",e[5])],x=!0)},p(t,[e]){if(2&e){let n;for(k=t[1],n=0;n<k.length;n+=1){const r=H(t,k,n);F[n]?F[n].p(r,e):(F[n]=I(r),F[n].c(),F[n].m(s.parentNode,s))}for(;n<F.length;n+=1)F[n].d(1);F.length=k.length}1&e&&m.value!==t[0]&&y(m,t[0]),4&e&&v.p(t[2])},i:t,o:t,d(t){t&&a(n),t&&a(o),t&&a(i),t&&a(c),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(F,t),t&&a(s),t&&a(f),x=!1,r(E)}}}function q(t){return t[t.length-1]}const z=t=>t.name;function D(t,e,n){var r;!function(t){t[t.File=0]="File",t[t.Folder=1]="Folder"}(r||(r={}));class o{constructor(t,e,n){this.name=t,this.type=e,this.content=null!=n?n:"",this.children={}}}let i=String.raw`
             _ _                      _          _ _ 
  ___  _ __ | (_)_ __   ___       ___| |__   ___| | |
 / _ \| '_ \| | | '_ \ / _ \_____/ __| '_ \ / _ \ | |
| (_) | | | | | | | | |  __/_____\__ \ | | |  __/ | |
 \___/|_| |_|_|_|_| |_|\___|     |___/_| |_|\___|_|_|
`,l=new o("~",r.Folder),c=[l];const s=()=>q(c);let u=(t,e)=>{let n=c.slice();for(;e.length>0;){console.log(`文件夹序列 = ${e}`);let o=e.shift();if(".."!==o){if(void 0===(t=t.children[o])||t.type===r.File)throw console.log("can't get to"),new Error("can't get to");n.push(t)}else n.length>1&&(n.pop(),t=q(n))}return n};let h=new Map([["ls",t=>Object.values(s().children).map((t=>`<div> ${t.name}  ${t.type===r.Folder?"文件夹":"文件"}</div>`)).join(" ")],["mkdir",t=>{const e=[],n=new Set(Object.keys(s().children));return t.map((t=>{n.has(t)?e.push(`mkdir: 无法创建目录 “${t}”: 文件已存在`):s().children[t]=new o(t,r.Folder)})),e.join("</br>")}],["cd",t=>{let e=t[0];if([...e].every((t=>"."===t))){let t=e.length;for(;t>1&&c.length>1;)c.pop(),t--;return""}if(e.includes("/"))return console.log(e),(t=>{let e=t.split("/");console.log(e);try{c=u(q(c),e)}catch(t){return"无此目录"}})(e),"";{let t=s().children[e];return void 0!==t&&t.type===r.Folder?(c.push(t),console.log("新建成功"),""):"can't cd to path"}}],["touch",t=>{const e=[],n=new Set(Object.keys(s().children));return t.map((t=>{n.has(t)?e.push(`touch: 无法创建目录 “${t}”: 文件已存在`):s().children[t]=new o(t,r.File)})),e.join("</br>")}],["cat",t=>{let e,n,o=t[0];if(o.includes("/")){const t=o.split("/");e=q(u(s(),t.slice(0,-1))).children,console.log(JSON.stringify(e)),n=q(t)}else e=s().children,n=o;return e.hasOwnProperty(n)&&e[n].type===r.File?e[n].content:`cat: ${o}: 没有那个文件`}],["echo",t=>{let e=t[0],n=t[2],i=s().children[n];return s().children.hasOwnProperty(n)&&i.type===r.Folder?`是一个目录: ${n}`:s().children.hasOwnProperty(n)?">"===t[1]?(i.content=e,"写入成功"):">>"===t[1]?(i.content+=e,"追加成功"):void 0:(s().children[n]=new o(n,r.File,e),"写入成功")}],["rm",t=>{const e=[],n=new Set(Object.keys(s().children));return[...new Set(t)].map((t=>{n.has(t)?delete s().children[t]:e.push(`rm: 无法删除 '${t}': 没有那个文件或目录`)})),e.join("</br>")}],["cp",t=>{let e=t[0].split("/"),n=q(e),r=t[1].split("/"),o=q(r),i=q(u(s(),e.slice(0,-1))).children[n];if(void 0===i)return"无此文件";console.log("复制成功"),console.log(`复制成功 后 目前位置 ${JSON.stringify(s())}`);let l=u(s(),r.slice(0,-1));return q(l).children[o]=i,q(l).children[o].name=o,""}],["clear",t=>(n(1,d=[{"目前指令":"","指令结果":"","当前路径":q(d).当前路径}]),"")],["exit",t=>(window.close(),"")],["tree",t=>function t(e,n="&nbsp;&nbsp;&nbsp;&nbsp;"){return e.type===r.File?`<div>${n} ${e.name} 文件</div>`:`<div>${n} ${e.name} 文件夹</div>\n          <div> ${Object.values(e.children).map((e=>t(e,n+"&nbsp;&nbsp;&nbsp;&nbsp;"))).join("<br/>")} \n          </div>`}(s(),"<br/>")]]);let a="",d=[{"目前指令":"","指令结果":"","当前路径":[l]}],f="";return[a,d,f,i,t=>{if("Enter"===t.key){if(""===a)return;n(2,f=function(t){let e=t.split(" "),n=e[0],r=e.slice(1);return new Set(h.keys()).has(n)?h.get(n)(r):"error, 无此指令"}(a)),"clear"!==a&&(n(1,d[d.length-1].目前指令=a,d),n(1,d[d.length-1].指令结果=f,d),d.push({"目前指令":"","指令结果":"","当前路径":c.concat()})),n(0,a=""),n(2,f="")}console.log(t.key)},function(){a=this.value,n(0,a)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),L(this,t,D,J,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
