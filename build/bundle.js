var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let i,c=!1;function s(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function h(t,e){c?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const l=s(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[l]+1;const i=l+1;n[i]=t,o=Math.max(i,o)}const l=[],i=[];let c=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(l.push(e[t-1]);c>=t;c--)i.push(e[c]);c--}for(;c>=0;c--)i.push(e[c]);l.reverse(),i.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<i.length;e++){for(;n<l.length&&i[e].claim_order>=l[n].claim_order;)n++;const r=n<l.length?l[n]:null;t.insertBefore(i[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function u(t,e,n){c&&!n?h(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function _(t){return document.createTextNode(t)}function g(){return _(" ")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function v(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}class w{constructor(t){this.e=this.n=null,this.l=t}m(t,e,n=null){this.e||(this.e=f(e.nodeName),this.t=e,this.l?this.n=this.l:this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)u(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(d)}}function b(t){i=t}const x=[],E=[],k=[],A=[],N=Promise.resolve();let S=!1;function O(t){k.push(t)}let j=!1;const B=new Set;function C(){if(!j){j=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];b(e),M(e.$$)}for(b(null),x.length=0;E.length;)E.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];B.has(e)||(B.add(e),e())}k.length=0}while(x.length);for(;A.length;)A.pop()();S=!1,j=!1,B.clear()}}function M(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const L=new Set;function T(t,e){-1===t.$$.dirty[0]&&(x.push(t),S||(S=!0,N.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function P(l,s,h,u,a,f,_=[-1]){const g=i;b(l);const p=l.$$={fragment:null,ctx:null,props:f,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(g?g.$$.context:s.context||[]),callbacks:n(),dirty:_,skip_bound:!1};let m=!1;if(p.ctx=h?h(l,s.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return p.ctx&&a(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),m&&T(l,t)),e})):[],p.update(),m=!0,r(p.before_update),p.fragment=!!u&&u(p.ctx),s.target){if(s.hydrate){c=!0;const t=function(t){return Array.from(t.childNodes)}(s.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();s.intro&&(($=l.$$.fragment)&&$.i&&(L.delete($),$.i(y))),function(t,n,l,i){const{fragment:c,on_mount:s,on_destroy:h,after_update:u}=t.$$;c&&c.m(n,l),i||O((()=>{const n=s.map(e).filter(o);h?h.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(O)}(l,s.target,s.anchor,s.customElement),c=!1,C()}var $,y;b(g)}function H(t,e,n){const r=t.slice();return r[15]=e[n],r}function J(t,e,n){const r=t.slice();return r[18]=e[n],r}function F(t){let e,n,r,o,l,i,c,s,a=t[18].当前路径.map(z).join("/")+"",p=t[18].目前指令+"",m=t[18].指令结果+"";return{c(){e=_("----------------------------------------------------\n  "),n=f("div"),r=_(a),o=g(),l=f("div"),i=_(p),c=g(),s=f("div")},m(t,d){u(t,e,d),u(t,n,d),h(n,r),u(t,o,d),u(t,l,d),h(l,i),u(t,c,d),u(t,s,d),s.innerHTML=m},p(t,e){2&e&&a!==(a=t[18].当前路径.map(z).join("/")+"")&&$(r,a),2&e&&p!==(p=t[18].目前指令+"")&&$(i,p),2&e&&m!==(m=t[18].指令结果+"")&&(s.innerHTML=m)},d(t){t&&d(e),t&&d(n),t&&d(o),t&&d(l),t&&d(c),t&&d(s)}}}function I(t){let e,n,r=JSON.stringify(t[15])+"";return{c(){e=f("div"),n=_(r)},m(t,r){u(t,e,r),h(e,n)},p(t,e){2&e&&r!==(r=JSON.stringify(t[15])+"")&&$(n,r)},d(t){t&&d(e)}}}function q(e){let n,o,l,i,c,s,$,b,x,E,k,A,N,S,O=e[1],j=[];for(let t=0;t<O.length;t+=1)j[t]=F(J(e,O,t));let B=e[1],C=[];for(let t=0;t<B.length;t+=1)C[t]=I(H(e,B,t));return{c(){n=f("a"),n.textContent="帮助",o=g(),l=f("div"),i=f("textarea"),c=g();for(let t=0;t<j.length;t+=1)j[t].c();s=g(),$=f("div"),b=f("input"),x=g(),E=new w,k=g();for(let t=0;t<C.length;t+=1)C[t].c();A=_(""),m(n,"target","_blank"),m(n,"href","https://github.com/wuyudi/OperatingSystem/tree/online-demo#%E4%B8%80%E4%B8%AA-shell-%E7%9A%84%E5%9C%A8%E7%BA%BF%E6%A8%A1%E6%8B%9F%E5%99%A8"),v(i,"font-family","Consolas"),v(i,"height","10rem"),v(i,"width","80rem"),v(i,"border-color","transparent"),i.value=e[3],v(b,"width","100%"),E.a=null},m(t,r){u(t,n,r),u(t,o,r),u(t,l,r),h(l,i),u(t,c,r);for(let e=0;e<j.length;e+=1)j[e].m(t,r);u(t,s,r),u(t,$,r),h($,b),y(b,e[0]),h($,x),E.m(e[2],$),u(t,k,r);for(let e=0;e<C.length;e+=1)C[e].m(t,r);u(t,A,r),N||(S=[p(window,"keydown",e[4]),p(b,"input",e[6])],N=!0)},p(t,[e]){if(2&e){let n;for(O=t[1],n=0;n<O.length;n+=1){const r=J(t,O,n);j[n]?j[n].p(r,e):(j[n]=F(r),j[n].c(),j[n].m(s.parentNode,s))}for(;n<j.length;n+=1)j[n].d(1);j.length=O.length}if(1&e&&b.value!==t[0]&&y(b,t[0]),4&e&&E.p(t[2]),2&e){let n;for(B=t[1],n=0;n<B.length;n+=1){const r=H(t,B,n);C[n]?C[n].p(r,e):(C[n]=I(r),C[n].c(),C[n].m(A.parentNode,A))}for(;n<C.length;n+=1)C[n].d(1);C.length=B.length}},i:t,o:t,d(t){t&&d(n),t&&d(o),t&&d(l),t&&d(c),a(j,t),t&&d(s),t&&d($),t&&d(k),a(C,t),t&&d(A),N=!1,r(S)}}}const z=t=>t.name;function D(t,e,n){class r{constructor(t,e){this.name=t,this.content=null!=e?e:""}}class o{constructor(t){this.name=t,this.dir_children={},this.file_children={}}}let l=String.raw`
             _ _                      _          _ _ 
  ___  _ __ | (_)_ __   ___       ___| |__   ___| | |
 / _ \| '_ \| | | '_ \ / _ \_____/ __| '_ \ / _ \ | |
| (_) | | | | | | | | |  __/_____\__ \ | | |  __/ | |
 \___/|_| |_|_|_|_| |_|\___|     |___/_| |_|\___|_|_|
`,i=new o("~"),c=[i];const s=()=>c[c.length-1];let h=(t,e)=>{let n=c.slice();for(;e.length>0;){console.log(`文件夹序列 = ${e}`);let r=e.shift();if(".."!==r){if(void 0===(t=t.dir_children[r]))throw console.log("can't get to"),new Error("can't get to");n.push(t)}else n.length>1&&(n.pop(),t=n[n.length-1])}return n};let u=new Map([["ls",t=>Object.keys(s().dir_children).map((t=>`<div> ${t}  文件夹</div>`)).join(" ")+Object.keys(s().file_children).map((t=>`<div> ${t}  文件</div>`)).join(" ")],["mkdir",t=>(t.map((t=>s().dir_children[t]=new o(t))),"")],["cd",t=>{let e=t[0];if([...e].every((t=>"."===t))){let t=e.length;for(;t>1&&c.length>1;)c.pop(),t--;return""}if(e.includes("/"))return console.log(e),(t=>{let e=t.split("/");console.log(e);try{n(5,c=h(c[c.length-1],e))}catch(t){return"无此目录"}})(e),"";{let t=s().dir_children[e];return void 0!==t?(c.push(t),console.log("新建成功"),""):"can't cd to path"}}],["touch",t=>(t.map((t=>s().file_children[t]=new r(t))),"创建完成")],["cat",t=>{let e=t[0];return s().file_children.hasOwnProperty(e)?s().file_children[e].content:`cat: ${e}: 没有那个文件`}],["echo",t=>{let e=t[0],n=t[2],o=s().file_children[n];return s().file_children.hasOwnProperty(n)?(s().file_children[n]=new r(n,e),""):">"===t[1]?(o.content=e,"写入成功"):">>"===t[1]?(o.content+=e,"追加成功"):void 0}],["rmdir",t=>([...new Set(t)].map((t=>delete s().dir_children[t])),"删除成功")],["rm",t=>([...new Set(t)].map((t=>delete s().file_children[t])),"删除成功")],["cp",t=>{let e=t[0].split("/"),n=e[e.length-1],o=t[1].split("/"),l=o[o.length-1],i=h(s(),e.slice(0,-1)),c=i[i.length-1].file_children[n];if(void 0===c)return"无此文件";console.log("复制成功"),console.log(`复制成功 后 目前位置 ${JSON.stringify(s())}`);let u=h(s(),o.slice(0,-1));return u[u.length-1].file_children[l]=new r(l,c.content),""}]]);let d="",a=[{"目前指令":"","指令结果":"","当前路径":[i]}],f="";return t.$$.update=()=>{32&t.$$.dirty&&(n(5,c),console.log(c))},[d,a,f,l,t=>{if("Enter"===t.key){if(""===d)return;n(2,f=function(t){let e=t.split(" "),n=e[0],r=e.slice(1);return new Set(u.keys()).has(n)?u.get(n)(r):"error, 无此指令"}(d)),n(1,a[a.length-1].目前指令=d,a),n(1,a[a.length-1].指令结果=f,a),a.push({"目前指令":"","指令结果":"","当前路径":c.concat()}),n(0,d=""),n(2,f="")}console.log(t.key)},c,function(){d=this.value,n(0,d)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),P(this,t,D,q,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
